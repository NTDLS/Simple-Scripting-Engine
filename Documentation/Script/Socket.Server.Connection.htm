<html>
<head>
<title>Socket :: Server :: Connection</title>
<meta name="MS-HKWD" content="WinSock">
<meta name="MS-HKWD" content="Networking">
<meta name="MS-HKWD" content="Servers">
<meta name="MS-HKWD" content="Clients">
<meta name="MS-HKWD" content="TCP/IP">
</head>

<body Background="/Images/BGCode.gif">
<font size="5">Socket :: Server :: Connection</font><br />
<hr /><br /><br />

<b>Description:</b>
<blockquote>
<!-- ##BEGIN_DESCRIPTION## -->
Acquires the Socket.Client instance for a connected peer. This retrieved instance can be used to interact with a remote peer.
<!-- ##END_DESCRIPTION## -->
</blockquote>

<b>Syntax:</b>
<blockquote>
<font color="0000EE">Socket.Server.Connection</font>(<font color="#000088">OutputClient</font> as <font color="MediumVioletRed">Socket.Client</font>, <font color="#000088">PeerIndex</font> as <font color="MediumVioletRed">Numeric</font> = <font color="Blue">-1</font>) as <font color="MediumVioletRed">Socket.Client</font> </blockquote>

<b>Parameters:</b>
<blockquote>
<ul><li><font color="#000088">OutputClient</font> as <font color="MediumVioletRed">String</font><ul><li>
Pointer to a predefined Socket.Client class
</ul><li><font color="#000088">PeerIndex</font> as <font color="MediumVioletRed">Numeric</font><ul><li>
Optional numeric representation (slot number) for a connected peer. If omitted, the function will act as an enumerator.
</ul></ul>
</blockquote>

<b>Example:</b>
<table  ><tr><td nowrap><div style=""><div style="display:none;" id="closed634288001778682635_1"><img src="/images/Code/PlusNoLines.gif" align=top onclick="open634288001778682635_1.style.display='block'; closed634288001778682635_1.style.display='none'; "><b><span style="color:#00008b;background-color:#c0c0c0;">&lt;%...%&gt;</span></b></div><div style="display:block;" id="open634288001778682635_1"><img src="/images/Code/minusNoTopLine.gif" align=top onclick="open634288001778682635_1.style.display='none'; closed634288001778682635_1.style.display='block'; "><span style="color:#000000;background-color:#ffff00;">&lt;%</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><b><span style="color:#0000ff">var</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">Server</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">as</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#c71585">Socket.Server</span></b><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000">Server</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Start</span><span style="color:#ff0000">(</span><b><span style="color:#008080">10</span></b><span style="color:#000000">,</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#008080">80</span></b><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<div style="display:none;" id="closed634288001778682635_7"><img src="/images/Code/plus.gif" align=top onclick="open634288001778682635_7.style.display='block'; closed634288001778682635_7.style.display='none'; "><b><span style="color:#00008b;background-color:#c0c0c0;">While&nbsp;(True)&nbsp;...</span></b></div><div style="display:block;" id="open634288001778682635_7"><img src="/images/Code/minus.gif" align=top onclick="open634288001778682635_7.style.display='none'; closed634288001778682635_7.style.display='block'; "><b><span style="color:#0000ff">while</span></b><span style="color:#ff0000">(</span><b><span style="color:#ff00ff">True</span></b><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><b><span style="color:#0000ff">var</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">Client</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">as</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#c71585">Socket.Client</span></b><br>
<img src="/images/Code/I.gif"  align=top><br>
<div style="display:none;" id="closed634288001778682635_10"><img src="/images/Code/plus.gif" align=top onclick="open634288001778682635_10.style.display='block'; closed634288001778682635_10.style.display='none'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#00008b;background-color:#c0c0c0;">If&nbsp;(Server.Connection(@Client))&nbsp;...</span></b></div><div style="display:block;" id="open634288001778682635_10"><img src="/images/Code/minus.gif" align=top onclick="open634288001778682635_10.style.display='none'; closed634288001778682635_10.style.display='block'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">If</span></b><span style="color:#ff0000">(</span><span style="color:#000000">Server</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Connection</span><span style="color:#ff0000">(</span><span style="color:#000000">@Client</span><span style="color:#ff0000">)</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">var</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">sReceive</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">as</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#c71585">String</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#ff0000">=</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">Client</span><span style="color:#ff0000">.</span><span style="color:#000000">RecvA</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<div style="display:none;" id="closed634288001778682635_12"><img src="/images/Code/plus.gif" align=top onclick="open634288001778682635_12.style.display='block'; closed634288001778682635_12.style.display='none'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#00008b;background-color:#c0c0c0;">If&nbsp;(sReceive.Length()&nbsp;&gt;&nbsp;0)&nbsp;...</span></b></div><div style="display:block;" id="open634288001778682635_12"><img src="/images/Code/minus.gif" align=top onclick="open634288001778682635_12.style.display='none'; closed634288001778682635_12.style.display='block'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">If</span></b><span style="color:#ff0000">(</span><span style="color:#000000">sReceive</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Length</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#ff0000">&gt;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#008080">0</span></b><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">Client</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Send</span><span style="color:#ff0000">(</span><span style="color:#ff0000">"</span><span style="color:#ff0000">Hello</span><span style="color:#ff0000">&nbsp;</span><span style="color:#ff0000">World</span><span style="color:#ff0000">"</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">Client</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Disconnect</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/L.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">End&nbsp;If</span></b></div>
<img src="/images/Code/L.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">End&nbsp;If</span></b></div>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#0000ff">Sleep</span><span style="color:#ff0000">(</span><b><span style="color:#008080">1</span></b><span style="color:#ff0000">)</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><i><span style="color:#008000">;</span></i><i><span style="color:#008000">Give</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">CPU</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">time</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">to</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">breathe.</span></i><br>
<img src="/images/Code/L.gif"  align=top><b><span style="color:#0000ff">WEnd</span></b></div>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000">Server</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Stop</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/L.gif"  align=top><span style="color:#000000;background-color:#ffff00;">%&gt;</span></div>
</div></td></tr></table>

</body>
</html>
