<html>
<head>
<title>SQL :: Connection :: Transaction :: Rollback</title>
<meta name="MS-HKWD" content="SQL Server">
<meta name="MS-HKWD" content="Database">
<meta name="MS-HKWD" content="Transaction">
</head>

<body Background="/Images/BGCode.gif">
<font size="5">SQL :: Connection :: Transaction :: Rollback</font><br />
<hr /><br /><br />

<b>Description:</b>
<blockquote>
<!-- ##BEGIN_DESCRIPTION## -->
Rolls back an explicit or implicit transaction to the beginning of the transaction, or to a savepoint inside the transaction.
<!-- ##END_DESCRIPTION## -->
</blockquote>

<b>Syntax:</b>
<blockquote>
<font color="0000EE">SQL.Connection.Transaction.Rollback</font>(<font color="#000088">Name</font> as <font color="MediumVioletRed">String</font> = NULL)</blockquote>

<b>Parameters:</b>
<blockquote>
<ul><li><font color="#000088">Name</font> as <font color="MediumVioletRed">String</font><ul><li>
Name assigned to the transaction. Identifiers longer than 32 characters are not allowed.
</ul></ul>
</blockquote>

<b>Example:</b>
<blockquote>
<table  ><tr><td nowrap><div style=""><div style="display:none;" id="closed634391047067390400_1"><img src="/images/Code/PlusNoLines.gif" align=top onclick="open634391047067390400_1.style.display='block'; closed634391047067390400_1.style.display='none'; "><b><span style="color:#00008b;background-color:#c0c0c0;">&lt;%...%&gt;</span></b></div><div style="display:block;" id="open634391047067390400_1"><img src="/images/Code/minusNoTopLine.gif" align=top onclick="open634391047067390400_1.style.display='none'; closed634391047067390400_1.style.display='block'; "><span style="color:#000000;background-color:#ffff00;">&lt;%</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><b><span style="color:#0000ff">var</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">sqlConn</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">as</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#c71585">SQL.Connection</span></b><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Connect</span><span style="color:#ff0000">(</span><span style="color:#ff0000">"</span><span style="color:#ff0000">.\\SQLExpress</span><span style="color:#ff0000">"</span><span style="color:#ff0000">)</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><i><span style="color:#008000">;</span></i><i><span style="color:#008000">SQL.Connect(Server,</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">[Database],</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">[Username],</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">[Password])</span></i><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><i><span style="color:#008000">;</span></i><i><span style="color:#008000">Begin</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">a</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">new</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">transation.</span></i><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Transaction.Begin</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<div style="display:none;" id="closed634391047067390400_10"><img src="/images/Code/plus.gif" align=top onclick="open634391047067390400_10.style.display='block'; closed634391047067390400_10.style.display='none'; "><b><span style="color:#00008b;background-color:#c0c0c0;">For&nbsp;(i&nbsp;as&nbsp;Numeric&nbsp;=&nbsp;0&nbsp;to&nbsp;100)&nbsp;...</span></b></div><div style="display:block;" id="open634391047067390400_10"><img src="/images/Code/minus.gif" align=top onclick="open634391047067390400_10.style.display='none'; closed634391047067390400_10.style.display='block'; "><b><span style="color:#0000ff">For</span></b><span style="color:#ff0000">(</span><span style="color:#000000">i</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">as</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#c71585">Numeric</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#ff0000">=</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#008080">0</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">to</span></b><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#008080">100</span></b><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><br>
<div style="display:none;" id="closed634391047067390400_12"><img src="/images/Code/plus.gif" align=top onclick="open634391047067390400_12.style.display='block'; closed634391047067390400_12.style.display='none'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><b><span style="color:#00008b;background-color:#c0c0c0;">Try&nbsp;&nbsp;...</span></b></div><div style="display:block;" id="open634391047067390400_12"><img src="/images/Code/minus.gif" align=top onclick="open634391047067390400_12.style.display='none'; closed634391047067390400_12.style.display='block'; "><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">Try</span></b><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Execute</span><span style="color:#ff0000">(</span><span style="color:#ff0000">"</span><span style="color:#ff0000">INSERT</span><span style="color:#ff0000">&nbsp;</span><span style="color:#ff0000">INTO</span><span style="color:#ff0000">&nbsp;</span><span style="color:#ff0000">Words(Word)</span><span style="color:#ff0000">&nbsp;</span><span style="color:#ff0000">VALUES</span><span style="color:#ff0000">&nbsp;</span><span style="color:#ff0000">('</span><span style="color:#ff0000">"</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">&amp;</span><span style="color:#000000">&nbsp;</span><span style="color:#000000">i</span><span style="color:#000000">&nbsp;</span><span style="color:#000000">&amp;</span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#ff0000">"</span><span style="color:#ff0000">')</span><span style="color:#ff0000">"</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">Catch</span></b><span style="color:#ff0000">(</span><span style="color:#000000">ex</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#0000ff">Print</span><span style="color:#ff0000">(</span><span style="color:#ff0000">"</span><span style="color:#ff0000">Error:</span><span style="color:#ff0000">"</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000">&amp;</span><span style="color:#000000">&nbsp;</span><span style="color:#000000">ex</span><span style="color:#ff0000">.</span><span style="color:#ff00ff">ErrorText</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><i><span style="color:#008000">;</span></i><i><span style="color:#008000">An</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">error</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">occured,</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">rollback</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">the</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">transaction</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">and</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">exit.</span></i><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Transaction.Rollback</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">Break</span></b><br>
<img src="/images/Code/L.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000"></span><b><span style="color:#0000ff">End&nbsp;Try</span></b></div>
<img src="/images/Code/L.gif"  align=top><b><span style="color:#0000ff">Next</span></b></div>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><i><span style="color:#008000">;</span></i><i><span style="color:#008000">If</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">we</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">are</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">still</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">in</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">a</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">transaction,</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">commit</span></i><i><span style="color:#008000">&nbsp;</span></i><i><span style="color:#008000">it.</span></i><br>
<div style="display:none;" id="closed634391047067390400_24"><img src="/images/Code/plus.gif" align=top onclick="open634391047067390400_24.style.display='block'; closed634391047067390400_24.style.display='none'; "><b><span style="color:#00008b;background-color:#c0c0c0;">If&nbsp;(sqlConn.Transaction.Depth()&nbsp;&gt;&nbsp;0)&nbsp;...</span></b></div><div style="display:block;" id="open634391047067390400_24"><img src="/images/Code/minus.gif" align=top onclick="open634391047067390400_24.style.display='none'; closed634391047067390400_24.style.display='block'; "><b><span style="color:#0000ff">If</span></b><span style="color:#ff0000">(</span><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Transaction.Depth</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><span style="color:#ff0000">&gt;</span><span style="color:#000000"></span><span style="color:#000000">&nbsp;</span><span style="color:#000000"></span><b><span style="color:#008080">0</span></b><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000"></span><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Transaction.Commit</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/L.gif"  align=top><b><span style="color:#0000ff">End&nbsp;If</span></b></div>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/I.gif"  align=top><span style="color:#000000">sqlConn</span><span style="color:#ff0000">.</span><span style="color:#0000ff">Close</span><span style="color:#ff0000">(</span><span style="color:#ff0000">)</span><br>
<img src="/images/Code/I.gif"  align=top><br>
<img src="/images/Code/L.gif"  align=top><span style="color:#000000;background-color:#ffff00;">%&gt;</span></div>
<img src="/images/Code/clear.gif"  align=top><br>
</div></td></tr></table>
</blockquote>

</body>
</html>
